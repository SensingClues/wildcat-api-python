{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "1f19cf4f",
   "metadata": {},
   "source": [
    "### How to make api "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "9672e85e",
   "metadata": {},
   "outputs": [],
   "source": [
    "from wildcatpy.api_calls import * "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "e04ad84b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: python-dotenv in /usr/local/lib/python3.10/site-packages (0.21.0)\n",
      "\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m A new release of pip available: \u001b[0m\u001b[31;49m22.2.2\u001b[0m\u001b[39;49m -> \u001b[0m\u001b[32;49m22.3.1\u001b[0m\n",
      "\u001b[1m[\u001b[0m\u001b[34;49mnotice\u001b[0m\u001b[1;39;49m]\u001b[0m\u001b[39;49m To update, run: \u001b[0m\u001b[32;49mpython3.10 -m pip install --upgrade pip\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "!python3 -m pip install python-dotenv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "8185d34d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "from dotenv import load_dotenv\n",
    "load_dotenv()\n",
    "\n",
    "username = os.getenv(\"USERNAME\") # you can also type your password here manually\n",
    "password = os.getenv('PASSWORD') # You can also type your username here manually\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "02217b48",
   "metadata": {},
   "outputs": [],
   "source": [
    "api_call = WildcatApi(username,password)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "c7720139",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'$version': '1.3.3-beta', 'models': {'9999': {'id': '9999', 'name': '9999', 'description': 'Creekish mountains Upload', 'layers': [{'id': 0, 'name': 'test_polygon', 'description': 'All Polygon geometries for layer test_polygon', 'geometryType': 'Polygon'}, {'id': 1, 'name': 'test_multipolygon', 'description': 'All MultiPolygon geometries for layer test_multipolygon', 'geometryType': 'MultiPolygon'}]}, 'track': {'id': 'track', 'name': 'track', 'description': 'Track layers', 'layers': [{'id': 0, 'name': 'Tracks', 'description': 'All MultiPoint geometries for Track', 'geometryType': 'MultiPoint'}]}, 'default': {'id': 'default', 'name': 'default', 'description': 'Default Entity layers', 'layers': [{'id': 0, 'name': 'Observations', 'description': 'All Point geometries for Observations', 'geometryType': 'Point'}, {'id': 1, 'name': 'Tracks', 'description': 'All Point geometries for Track', 'geometryType': 'Point'}, {'id': 2, 'name': 'Agents', 'description': 'All Point geometries for Agent', 'geometryType': 'Point'}]}}}\n"
     ]
    }
   ],
   "source": [
    "# with this private func we can make a call so we can test new api's \n",
    "\n",
    "add = \"/map/all/describe\" # this is what has to be added to standard ->https://focus.sensingclues.org/api/\n",
    "output = api_call._api_call(\"get\", add, {}).json()\n",
    "print(output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "5de814c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'cols_to_data': [],\n",
       " 'extractor': {'extract_values': ['pid'],\n",
       "  'layers': {'explode_values': ['id', 'name', 'geometryType']}}}"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# this is the json file I made to extract the correct values \n",
    "# What it does it it goes deeper in the dict (models) and starts looping if possible\n",
    "# Per row it will extract the values in the extract_values argument\n",
    "# It will explode every row with values that are in the explode_values\n",
    "# What happens now it makes a new row for the default and for the tracks\n",
    "# But both are containing the extract_values \n",
    "# We fix this afterwards by filtering. Normally we don't want seperated rows when exploding muliple times\n",
    "{\n",
    "  \"cols_to_data\": [],\n",
    "  \"extractor\": {\n",
    "    \"extract_values\": [\n",
    "      \"pid\"\n",
    "    ],\n",
    "    \"layers\": {\n",
    "      \"explode_values\": [\n",
    "        \"id\",\n",
    "        \"name\",\n",
    "        \"geometryType\"\n",
    "      ]\n",
    "    }\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "b9e37c99",
   "metadata": {},
   "outputs": [],
   "source": [
    "# small change because the extractor needs a list from which it can start extracting\n",
    "# The input data is a dict from which the key(pid) gives a dict with the info\n",
    "# So we convert the dict to a list of dicts and add the pid as item in the list\n",
    "# Then we can start iterating through this with the extractor beause it is the same strcuture as other calls\n",
    "new_output = [{**{\"pid\": key}, **output[\"models\"][key]} for key in output[\"models\"].keys()]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "84009efe",
   "metadata": {},
   "outputs": [],
   "source": [
    "extr = dataExtractor(\"all_layers\")\n",
    "extr_output = extr.extr(new_output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "b1de60cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "col_trans = {\n",
    "    \"id\": \"lid\"\n",
    "}\n",
    "df = pd.DataFrame(extr_output)\\\n",
    "       .rename(columns=col_trans)\\\n",
    "       .query(\"pid != 'track' and pid != 'default'\")\n",
    "#df = df.loc[~df[\"pid\"].isin([\"track\", \"default\"])]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "ab23ee2e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pid</th>\n",
       "      <th>lid</th>\n",
       "      <th>name</th>\n",
       "      <th>geometryType</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9999</td>\n",
       "      <td>0</td>\n",
       "      <td>test_polygon</td>\n",
       "      <td>Polygon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9999</td>\n",
       "      <td>1</td>\n",
       "      <td>test_multipolygon</td>\n",
       "      <td>MultiPolygon</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    pid  lid               name  geometryType\n",
       "0  9999    0       test_polygon       Polygon\n",
       "1  9999    1  test_multipolygon  MultiPolygon"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "dbcc3178",
   "metadata": {},
   "outputs": [],
   "source": [
    "# this is a very simple one so we just make a standard private function in the class\n",
    "# This should be a private function because it is only used by other functions and not by the users\n",
    "# Private means that you start the function with a _  (also not visible in documenation by user then)\n",
    "\n",
    "# To test this new function we extend the WildcatAPi Class \n",
    "# Then we make the variable url_addition\n",
    "# Then use the _api_call function and provide the type request, url_addition and payload if needed\n",
    "# This function returns all the models\n",
    "# Normally we use an extraction but since this function returns almost everything it is not needed.\n",
    "# If the function works here you can implement it in the api_calls.py\n",
    "\n",
    "class testNewAPi(WildcatApi):\n",
    "    def _get_all_layers(self):\n",
    "        col_trans = {\n",
    "            \"id\": \"lid\",\n",
    "            \"name\": \"layerName\"\n",
    "                }\n",
    "        url_addition = \"/map/all/describe\"\n",
    "        r = self._api_call(\"get\", url_addition)\n",
    "        output = r.json()\n",
    "        new_output = [{**{\"pid\": key}, **output[\"models\"][key]} for key in output[\"models\"].keys()]\n",
    "        extr = dataExtractor(\"all_layers\")\n",
    "        extr_output = extr.extr(new_output)\n",
    "        return pd.DataFrame(extr_output)\\\n",
    "                 .rename(columns=col_trans)\\\n",
    "                 .query(\"pid != 'track' and pid != 'default'\")\n",
    "    \n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "6546cfcd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pid</th>\n",
       "      <th>lid</th>\n",
       "      <th>layerName</th>\n",
       "      <th>geometryType</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>9999</td>\n",
       "      <td>0</td>\n",
       "      <td>test_polygon</td>\n",
       "      <td>Polygon</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>9999</td>\n",
       "      <td>1</td>\n",
       "      <td>test_multipolygon</td>\n",
       "      <td>MultiPolygon</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    pid  lid          layerName  geometryType\n",
       "0  9999    0       test_polygon       Polygon\n",
       "1  9999    1  test_multipolygon  MultiPolygon"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# run test if it works\n",
    "# if so we can implement it \n",
    "test = testNewAPi(username,password)\n",
    "test._get_all_layers()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "9307b53b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'cols_to_data': ['features'],\n",
       " 'extractor': {'extract_values': ['geometry', 'type', 'id', 'properties']}}"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "{\n",
    "  \"cols_to_data\": [\"features\"],\n",
    "  \"extractor\": {\n",
    "    \"extract_values\": [\n",
    "      \"geometry\",\n",
    "      \"type\",\n",
    "      \"id\",\n",
    "      \"properties\"\n",
    "    ]\n",
    "\n",
    "  }\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "05f70cd9",
   "metadata": {},
   "source": [
    "## Part 2 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "96fa57fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "#call again\n",
    "# with this private func we can make a call so we can test new api's \n",
    "project_id = 8950\n",
    "layer_id = 9\n",
    "add = f\"/map/all/{project_id}/{layer_id}/features/\" # this is what has to be added to standard ->https://focus.sensingclues.org/api/\n",
    "output = api_call._api_call(\"post\", add, {}).json()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "d1c1d4bf",
   "metadata": {},
   "outputs": [],
   "source": [
    "extr = dataExtractor(\"layer_details\")\n",
    "extr_output = extr.extr(output, nested_col_names=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "76fb3124",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'type': 'Feature',\n",
       " 'Id': '181944078',\n",
       " 'properties': {'DocId': '/GeoFeature/G8950-4351274340491204675-1.json',\n",
       "  'ShortId': '181944078',\n",
       "  'OBJECTID': '181944078',\n",
       "  'EntityId': 'G8950-4351274340491204675-1',\n",
       "  'Id': '181944078',\n",
       "  'name': 'Bachuma Graziers',\n",
       "  'Shape_Leng': '31710.3250861',\n",
       "  'Shape_Area': '41542671.9075',\n",
       "  'name_2': 'LMD',\n",
       "  'shape_le_1': '35319.0690104',\n",
       "  'shape_ar_1': '44051493.9094',\n",
       "  'id_2': '0',\n",
       "  'Area': '0',\n",
       "  'Acre': '0',\n",
       "  'Hectare': '0',\n",
       "  'shape_le_2': '83909.5919082',\n",
       "  'shape_ar_2': '301557600.749',\n",
       "  'Names': None},\n",
       " 'geometry': {'type': 'MultiPolygon',\n",
       "  'coordinates': [[[[38.83568, -3.7024],\n",
       "     [38.83568, -3.7024],\n",
       "     [38.83568, -3.7024],\n",
       "     [38.83568, -3.7024],\n",
       "     [38.83568, -3.7024]]]]}}"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output[\"features\"][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "bb280503",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>_type</th>\n",
       "      <th>_Id</th>\n",
       "      <th>geometry_type</th>\n",
       "      <th>geometry_coordinates</th>\n",
       "      <th>properties_DocId</th>\n",
       "      <th>properties_ShortId</th>\n",
       "      <th>properties_OBJECTID</th>\n",
       "      <th>properties_EntityId</th>\n",
       "      <th>properties_Id</th>\n",
       "      <th>properties_name</th>\n",
       "      <th>...</th>\n",
       "      <th>properties_name_2</th>\n",
       "      <th>properties_shape_le_1</th>\n",
       "      <th>properties_shape_ar_1</th>\n",
       "      <th>properties_id_2</th>\n",
       "      <th>properties_Area</th>\n",
       "      <th>properties_Acre</th>\n",
       "      <th>properties_Hectare</th>\n",
       "      <th>properties_shape_le_2</th>\n",
       "      <th>properties_shape_ar_2</th>\n",
       "      <th>properties_Names</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Feature</td>\n",
       "      <td>181944078</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.83568, -3.7024], [38.83568, -3.7024], [...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-1.json</td>\n",
       "      <td>181944078</td>\n",
       "      <td>181944078</td>\n",
       "      <td>G8950-4351274340491204675-1</td>\n",
       "      <td>181944078</td>\n",
       "      <td>Bachuma Graziers</td>\n",
       "      <td>...</td>\n",
       "      <td>LMD</td>\n",
       "      <td>35319.0690104</td>\n",
       "      <td>44051493.9094</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>83909.5919082</td>\n",
       "      <td>301557600.749</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Feature</td>\n",
       "      <td>136949067</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.86825, -3.9845], [38.80027, -4.01189], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-10.json</td>\n",
       "      <td>136949067</td>\n",
       "      <td>136949067</td>\n",
       "      <td>G8950-4351274340491204675-10</td>\n",
       "      <td>136949067</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30505.6573528</td>\n",
       "      <td>55268230.5007</td>\n",
       "      <td>Dawida</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Feature</td>\n",
       "      <td>93794630</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.9799, -3.8876], [38.95808, -3.93669], [...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-11.json</td>\n",
       "      <td>93794630</td>\n",
       "      <td>93794630</td>\n",
       "      <td>G8950-4351274340491204675-11</td>\n",
       "      <td>93794630</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>52727.9566204</td>\n",
       "      <td>105948252.961</td>\n",
       "      <td>Kambanga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Feature</td>\n",
       "      <td>50640194</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.60494, -3.94115], [38.60308, -3.94266],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-12.json</td>\n",
       "      <td>50640194</td>\n",
       "      <td>50640194</td>\n",
       "      <td>G8950-4351274340491204675-12</td>\n",
       "      <td>50640194</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>64208.444143</td>\n",
       "      <td>214464774.168</td>\n",
       "      <td>Kasigau</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Feature</td>\n",
       "      <td>7485757</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.63248, -3.71275], [38.5959, -3.74155], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-13.json</td>\n",
       "      <td>7485757</td>\n",
       "      <td>7485757</td>\n",
       "      <td>G8950-4351274340491204675-13</td>\n",
       "      <td>7485757</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>61148.1238153</td>\n",
       "      <td>216654799.741</td>\n",
       "      <td>Maungu</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Feature</td>\n",
       "      <td>393828050</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.55868, -3.63515], [38.43789, -3.7139], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-14.json</td>\n",
       "      <td>393828050</td>\n",
       "      <td>393828050</td>\n",
       "      <td>G8950-4351274340491204675-14</td>\n",
       "      <td>393828050</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>73531.3442841</td>\n",
       "      <td>212443232.428</td>\n",
       "      <td>Mgeno</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Feature</td>\n",
       "      <td>350673613</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.67465, -3.48646], [38.69489, -3.50914],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-15.json</td>\n",
       "      <td>350673613</td>\n",
       "      <td>350673613</td>\n",
       "      <td>G8950-4351274340491204675-15</td>\n",
       "      <td>350673613</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>23080.3503058</td>\n",
       "      <td>18550156.4601</td>\n",
       "      <td>Ndara</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Feature</td>\n",
       "      <td>307519176</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.93886, -3.68704], [38.94253, -3.7031], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-16.json</td>\n",
       "      <td>307519176</td>\n",
       "      <td>307519176</td>\n",
       "      <td>G8950-4351274340491204675-16</td>\n",
       "      <td>307519176</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>84023.1507562</td>\n",
       "      <td>409022474.063</td>\n",
       "      <td>Taita</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Feature</td>\n",
       "      <td>264364740</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.81494, -3.60187], [38.8495, -3.62182], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-17.json</td>\n",
       "      <td>264364740</td>\n",
       "      <td>264364740</td>\n",
       "      <td>G8950-4351274340491204675-17</td>\n",
       "      <td>264364740</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>18034.4184896</td>\n",
       "      <td>20319283.1318</td>\n",
       "      <td>Wangala</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Feature</td>\n",
       "      <td>221210303</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.80027, -4.01189], [38.69151, -4.05298],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-18.json</td>\n",
       "      <td>221210303</td>\n",
       "      <td>221210303</td>\n",
       "      <td>G8950-4351274340491204675-18</td>\n",
       "      <td>221210303</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>52879.5289938</td>\n",
       "      <td>136987903.991</td>\n",
       "      <td>Washumbu</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Feature</td>\n",
       "      <td>178055866</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.6553, -3.50696], [38.69489, -3.50914], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-19.json</td>\n",
       "      <td>178055866</td>\n",
       "      <td>178055866</td>\n",
       "      <td>G8950-4351274340491204675-19</td>\n",
       "      <td>178055866</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>68658.7943485</td>\n",
       "      <td>171217866.815</td>\n",
       "      <td>Sagalla</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Feature</td>\n",
       "      <td>138789642</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.84098, -3.69404], [38.8358, -3.7025], [...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-2.json</td>\n",
       "      <td>138789642</td>\n",
       "      <td>138789642</td>\n",
       "      <td>G8950-4351274340491204675-2</td>\n",
       "      <td>138789642</td>\n",
       "      <td>Bachuma Graziers</td>\n",
       "      <td>...</td>\n",
       "      <td>LMD</td>\n",
       "      <td>35319.0690104</td>\n",
       "      <td>44051493.9094</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Feature</td>\n",
       "      <td>39229677</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.79244, -3.58106], [38.79254, -3.58112],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-20.json</td>\n",
       "      <td>39229677</td>\n",
       "      <td>39229677</td>\n",
       "      <td>G8950-4351274340491204675-20</td>\n",
       "      <td>39229677</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5933.0520506</td>\n",
       "      <td>1563462.93747</td>\n",
       "      <td>Corridor_link</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Feature</td>\n",
       "      <td>425571970</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.29736, -3.63104], [38.35962, -3.64761],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-21.json</td>\n",
       "      <td>425571970</td>\n",
       "      <td>425571970</td>\n",
       "      <td>G8950-4351274340491204675-21</td>\n",
       "      <td>425571970</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30259.0381121</td>\n",
       "      <td>53047087.356</td>\n",
       "      <td>Kutima</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Feature</td>\n",
       "      <td>382417533</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.37393, -3.64864], [38.38037, -3.64911],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-22.json</td>\n",
       "      <td>382417533</td>\n",
       "      <td>382417533</td>\n",
       "      <td>G8950-4351274340491204675-22</td>\n",
       "      <td>382417533</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>29367.8169499</td>\n",
       "      <td>51304400.835</td>\n",
       "      <td>Choke</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Feature</td>\n",
       "      <td>339263097</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.70428, -3.65056], [38.70539, -3.65062],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-23.json</td>\n",
       "      <td>339263097</td>\n",
       "      <td>339263097</td>\n",
       "      <td>G8950-4351274340491204675-23</td>\n",
       "      <td>339263097</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>15</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>36156.9779811</td>\n",
       "      <td>10299218.4841</td>\n",
       "      <td>Marungu hills</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Feature</td>\n",
       "      <td>296108660</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.81494, -3.60187], [38.78068, -3.65734],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-24.json</td>\n",
       "      <td>296108660</td>\n",
       "      <td>296108660</td>\n",
       "      <td>G8950-4351274340491204675-24</td>\n",
       "      <td>296108660</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>83909.5919082</td>\n",
       "      <td>301557600.749</td>\n",
       "      <td>Rukinga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Feature</td>\n",
       "      <td>95635205</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.83568, -3.7024], [38.83568, -3.7024], [...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-3.json</td>\n",
       "      <td>95635205</td>\n",
       "      <td>95635205</td>\n",
       "      <td>G8950-4351274340491204675-3</td>\n",
       "      <td>95635205</td>\n",
       "      <td>Bachuma Graziers</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>83909.5919082</td>\n",
       "      <td>301557600.749</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Feature</td>\n",
       "      <td>52480768</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.8495, -3.62182], [38.87702, -3.63722], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-4.json</td>\n",
       "      <td>52480768</td>\n",
       "      <td>52480768</td>\n",
       "      <td>G8950-4351274340491204675-4</td>\n",
       "      <td>52480768</td>\n",
       "      <td>Bachuma Graziers</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>Bachuma Graziers</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Feature</td>\n",
       "      <td>9326332</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.93326, -3.68418], [38.93249, -3.68544],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-5.json</td>\n",
       "      <td>9326332</td>\n",
       "      <td>9326332</td>\n",
       "      <td>G8950-4351274340491204675-5</td>\n",
       "      <td>9326332</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>LMD</td>\n",
       "      <td>35319.0690104</td>\n",
       "      <td>44051493.9094</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>84023.1507562</td>\n",
       "      <td>409022474.063</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Feature</td>\n",
       "      <td>395668624</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.83235, -3.70764], [38.83568, -3.7024], ...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-6.json</td>\n",
       "      <td>395668624</td>\n",
       "      <td>395668624</td>\n",
       "      <td>G8950-4351274340491204675-6</td>\n",
       "      <td>395668624</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>LMD</td>\n",
       "      <td>35319.0690104</td>\n",
       "      <td>44051493.9094</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>83909.5919082</td>\n",
       "      <td>301557600.749</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Feature</td>\n",
       "      <td>352514188</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.87702, -3.63722], [38.93958, -3.67379],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-7.json</td>\n",
       "      <td>352514188</td>\n",
       "      <td>352514188</td>\n",
       "      <td>G8950-4351274340491204675-7</td>\n",
       "      <td>352514188</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>LMD</td>\n",
       "      <td>35319.0690104</td>\n",
       "      <td>44051493.9094</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>LMD</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Feature</td>\n",
       "      <td>309359751</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.78296, -3.61898], [38.7829, -3.6191], [...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-8.json</td>\n",
       "      <td>309359751</td>\n",
       "      <td>309359751</td>\n",
       "      <td>G8950-4351274340491204675-8</td>\n",
       "      <td>309359751</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>22016107.2441</td>\n",
       "      <td>5396.26635421</td>\n",
       "      <td>2202</td>\n",
       "      <td>19297.6903492</td>\n",
       "      <td>22016109.3623</td>\n",
       "      <td>jojoba</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Feature</td>\n",
       "      <td>266205314</td>\n",
       "      <td>MultiPolygon</td>\n",
       "      <td>[[[[38.77323, -3.94426], [38.77815, -3.87676],...</td>\n",
       "      <td>/GeoFeature/G8950-4351274340491204675-9.json</td>\n",
       "      <td>266205314</td>\n",
       "      <td>266205314</td>\n",
       "      <td>G8950-4351274340491204675-9</td>\n",
       "      <td>266205314</td>\n",
       "      <td>None</td>\n",
       "      <td>...</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>31219.6395812</td>\n",
       "      <td>59567669.1923</td>\n",
       "      <td>Amaka</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      _type        _Id geometry_type  \\\n",
       "0   Feature  181944078  MultiPolygon   \n",
       "1   Feature  136949067  MultiPolygon   \n",
       "2   Feature   93794630  MultiPolygon   \n",
       "3   Feature   50640194  MultiPolygon   \n",
       "4   Feature    7485757  MultiPolygon   \n",
       "5   Feature  393828050  MultiPolygon   \n",
       "6   Feature  350673613  MultiPolygon   \n",
       "7   Feature  307519176  MultiPolygon   \n",
       "8   Feature  264364740  MultiPolygon   \n",
       "9   Feature  221210303  MultiPolygon   \n",
       "10  Feature  178055866  MultiPolygon   \n",
       "11  Feature  138789642  MultiPolygon   \n",
       "12  Feature   39229677  MultiPolygon   \n",
       "13  Feature  425571970  MultiPolygon   \n",
       "14  Feature  382417533  MultiPolygon   \n",
       "15  Feature  339263097  MultiPolygon   \n",
       "16  Feature  296108660  MultiPolygon   \n",
       "17  Feature   95635205  MultiPolygon   \n",
       "18  Feature   52480768  MultiPolygon   \n",
       "19  Feature    9326332  MultiPolygon   \n",
       "20  Feature  395668624  MultiPolygon   \n",
       "21  Feature  352514188  MultiPolygon   \n",
       "22  Feature  309359751  MultiPolygon   \n",
       "23  Feature  266205314  MultiPolygon   \n",
       "\n",
       "                                 geometry_coordinates  \\\n",
       "0   [[[[38.83568, -3.7024], [38.83568, -3.7024], [...   \n",
       "1   [[[[38.86825, -3.9845], [38.80027, -4.01189], ...   \n",
       "2   [[[[38.9799, -3.8876], [38.95808, -3.93669], [...   \n",
       "3   [[[[38.60494, -3.94115], [38.60308, -3.94266],...   \n",
       "4   [[[[38.63248, -3.71275], [38.5959, -3.74155], ...   \n",
       "5   [[[[38.55868, -3.63515], [38.43789, -3.7139], ...   \n",
       "6   [[[[38.67465, -3.48646], [38.69489, -3.50914],...   \n",
       "7   [[[[38.93886, -3.68704], [38.94253, -3.7031], ...   \n",
       "8   [[[[38.81494, -3.60187], [38.8495, -3.62182], ...   \n",
       "9   [[[[38.80027, -4.01189], [38.69151, -4.05298],...   \n",
       "10  [[[[38.6553, -3.50696], [38.69489, -3.50914], ...   \n",
       "11  [[[[38.84098, -3.69404], [38.8358, -3.7025], [...   \n",
       "12  [[[[38.79244, -3.58106], [38.79254, -3.58112],...   \n",
       "13  [[[[38.29736, -3.63104], [38.35962, -3.64761],...   \n",
       "14  [[[[38.37393, -3.64864], [38.38037, -3.64911],...   \n",
       "15  [[[[38.70428, -3.65056], [38.70539, -3.65062],...   \n",
       "16  [[[[38.81494, -3.60187], [38.78068, -3.65734],...   \n",
       "17  [[[[38.83568, -3.7024], [38.83568, -3.7024], [...   \n",
       "18  [[[[38.8495, -3.62182], [38.87702, -3.63722], ...   \n",
       "19  [[[[38.93326, -3.68418], [38.93249, -3.68544],...   \n",
       "20  [[[[38.83235, -3.70764], [38.83568, -3.7024], ...   \n",
       "21  [[[[38.87702, -3.63722], [38.93958, -3.67379],...   \n",
       "22  [[[[38.78296, -3.61898], [38.7829, -3.6191], [...   \n",
       "23  [[[[38.77323, -3.94426], [38.77815, -3.87676],...   \n",
       "\n",
       "                                 properties_DocId properties_ShortId  \\\n",
       "0    /GeoFeature/G8950-4351274340491204675-1.json          181944078   \n",
       "1   /GeoFeature/G8950-4351274340491204675-10.json          136949067   \n",
       "2   /GeoFeature/G8950-4351274340491204675-11.json           93794630   \n",
       "3   /GeoFeature/G8950-4351274340491204675-12.json           50640194   \n",
       "4   /GeoFeature/G8950-4351274340491204675-13.json            7485757   \n",
       "5   /GeoFeature/G8950-4351274340491204675-14.json          393828050   \n",
       "6   /GeoFeature/G8950-4351274340491204675-15.json          350673613   \n",
       "7   /GeoFeature/G8950-4351274340491204675-16.json          307519176   \n",
       "8   /GeoFeature/G8950-4351274340491204675-17.json          264364740   \n",
       "9   /GeoFeature/G8950-4351274340491204675-18.json          221210303   \n",
       "10  /GeoFeature/G8950-4351274340491204675-19.json          178055866   \n",
       "11   /GeoFeature/G8950-4351274340491204675-2.json          138789642   \n",
       "12  /GeoFeature/G8950-4351274340491204675-20.json           39229677   \n",
       "13  /GeoFeature/G8950-4351274340491204675-21.json          425571970   \n",
       "14  /GeoFeature/G8950-4351274340491204675-22.json          382417533   \n",
       "15  /GeoFeature/G8950-4351274340491204675-23.json          339263097   \n",
       "16  /GeoFeature/G8950-4351274340491204675-24.json          296108660   \n",
       "17   /GeoFeature/G8950-4351274340491204675-3.json           95635205   \n",
       "18   /GeoFeature/G8950-4351274340491204675-4.json           52480768   \n",
       "19   /GeoFeature/G8950-4351274340491204675-5.json            9326332   \n",
       "20   /GeoFeature/G8950-4351274340491204675-6.json          395668624   \n",
       "21   /GeoFeature/G8950-4351274340491204675-7.json          352514188   \n",
       "22   /GeoFeature/G8950-4351274340491204675-8.json          309359751   \n",
       "23   /GeoFeature/G8950-4351274340491204675-9.json          266205314   \n",
       "\n",
       "   properties_OBJECTID           properties_EntityId properties_Id  \\\n",
       "0            181944078   G8950-4351274340491204675-1     181944078   \n",
       "1            136949067  G8950-4351274340491204675-10     136949067   \n",
       "2             93794630  G8950-4351274340491204675-11      93794630   \n",
       "3             50640194  G8950-4351274340491204675-12      50640194   \n",
       "4              7485757  G8950-4351274340491204675-13       7485757   \n",
       "5            393828050  G8950-4351274340491204675-14     393828050   \n",
       "6            350673613  G8950-4351274340491204675-15     350673613   \n",
       "7            307519176  G8950-4351274340491204675-16     307519176   \n",
       "8            264364740  G8950-4351274340491204675-17     264364740   \n",
       "9            221210303  G8950-4351274340491204675-18     221210303   \n",
       "10           178055866  G8950-4351274340491204675-19     178055866   \n",
       "11           138789642   G8950-4351274340491204675-2     138789642   \n",
       "12            39229677  G8950-4351274340491204675-20      39229677   \n",
       "13           425571970  G8950-4351274340491204675-21     425571970   \n",
       "14           382417533  G8950-4351274340491204675-22     382417533   \n",
       "15           339263097  G8950-4351274340491204675-23     339263097   \n",
       "16           296108660  G8950-4351274340491204675-24     296108660   \n",
       "17            95635205   G8950-4351274340491204675-3      95635205   \n",
       "18            52480768   G8950-4351274340491204675-4      52480768   \n",
       "19             9326332   G8950-4351274340491204675-5       9326332   \n",
       "20           395668624   G8950-4351274340491204675-6     395668624   \n",
       "21           352514188   G8950-4351274340491204675-7     352514188   \n",
       "22           309359751   G8950-4351274340491204675-8     309359751   \n",
       "23           266205314   G8950-4351274340491204675-9     266205314   \n",
       "\n",
       "     properties_name  ... properties_name_2 properties_shape_le_1  \\\n",
       "0   Bachuma Graziers  ...               LMD         35319.0690104   \n",
       "1               None  ...              None                  None   \n",
       "2               None  ...              None                  None   \n",
       "3               None  ...              None                  None   \n",
       "4               None  ...              None                  None   \n",
       "5               None  ...              None                  None   \n",
       "6               None  ...              None                  None   \n",
       "7               None  ...              None                  None   \n",
       "8               None  ...              None                  None   \n",
       "9               None  ...              None                  None   \n",
       "10              None  ...              None                  None   \n",
       "11  Bachuma Graziers  ...               LMD         35319.0690104   \n",
       "12              None  ...              None                  None   \n",
       "13              None  ...              None                  None   \n",
       "14              None  ...              None                  None   \n",
       "15              None  ...              None                  None   \n",
       "16              None  ...              None                  None   \n",
       "17  Bachuma Graziers  ...              None                  None   \n",
       "18  Bachuma Graziers  ...              None                  None   \n",
       "19              None  ...               LMD         35319.0690104   \n",
       "20              None  ...               LMD         35319.0690104   \n",
       "21              None  ...               LMD         35319.0690104   \n",
       "22              None  ...              None                  None   \n",
       "23              None  ...              None                  None   \n",
       "\n",
       "   properties_shape_ar_1 properties_id_2 properties_Area properties_Acre  \\\n",
       "0          44051493.9094               0               0               0   \n",
       "1                   None               1               0               0   \n",
       "2                   None               2               0               0   \n",
       "3                   None               3               0               0   \n",
       "4                   None               4               0               0   \n",
       "5                   None               5               0               0   \n",
       "6                   None               6               0               0   \n",
       "7                   None               7               0               0   \n",
       "8                   None               8               0               0   \n",
       "9                   None               9               0               0   \n",
       "10                  None              10               0               0   \n",
       "11         44051493.9094            None            None            None   \n",
       "12                  None              11               0               0   \n",
       "13                  None              13               0               0   \n",
       "14                  None              14               0               0   \n",
       "15                  None              15               0               0   \n",
       "16                  None               0               0               0   \n",
       "17                  None               0               0               0   \n",
       "18                  None            None            None            None   \n",
       "19         44051493.9094               7               0               0   \n",
       "20         44051493.9094               0               0               0   \n",
       "21         44051493.9094            None            None            None   \n",
       "22                  None               0   22016107.2441   5396.26635421   \n",
       "23                  None               0               0               0   \n",
       "\n",
       "   properties_Hectare properties_shape_le_2 properties_shape_ar_2  \\\n",
       "0                   0         83909.5919082         301557600.749   \n",
       "1                   0         30505.6573528         55268230.5007   \n",
       "2                   0         52727.9566204         105948252.961   \n",
       "3                   0          64208.444143         214464774.168   \n",
       "4                   0         61148.1238153         216654799.741   \n",
       "5                   0         73531.3442841         212443232.428   \n",
       "6                   0         23080.3503058         18550156.4601   \n",
       "7                   0         84023.1507562         409022474.063   \n",
       "8                   0         18034.4184896         20319283.1318   \n",
       "9                   0         52879.5289938         136987903.991   \n",
       "10                  0         68658.7943485         171217866.815   \n",
       "11               None                  None                  None   \n",
       "12                  0          5933.0520506         1563462.93747   \n",
       "13                  0         30259.0381121          53047087.356   \n",
       "14                  0         29367.8169499          51304400.835   \n",
       "15                  0         36156.9779811         10299218.4841   \n",
       "16                  0         83909.5919082         301557600.749   \n",
       "17                  0         83909.5919082         301557600.749   \n",
       "18               None                  None                  None   \n",
       "19                  0         84023.1507562         409022474.063   \n",
       "20                  0         83909.5919082         301557600.749   \n",
       "21               None                  None                  None   \n",
       "22               2202         19297.6903492         22016109.3623   \n",
       "23                  0         31219.6395812         59567669.1923   \n",
       "\n",
       "    properties_Names  \n",
       "0               None  \n",
       "1             Dawida  \n",
       "2           Kambanga  \n",
       "3            Kasigau  \n",
       "4             Maungu  \n",
       "5              Mgeno  \n",
       "6              Ndara  \n",
       "7              Taita  \n",
       "8            Wangala  \n",
       "9           Washumbu  \n",
       "10           Sagalla  \n",
       "11              None  \n",
       "12     Corridor_link  \n",
       "13            Kutima  \n",
       "14             Choke  \n",
       "15     Marungu hills  \n",
       "16           Rukinga  \n",
       "17              None  \n",
       "18  Bachuma Graziers  \n",
       "19              None  \n",
       "20              None  \n",
       "21               LMD  \n",
       "22            jojoba  \n",
       "23             Amaka  \n",
       "\n",
       "[24 rows x 22 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gpd.DataFrame(extr_output)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "3aa97f0e",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "invalid syntax. Maybe you meant '==' or ':=' instead of '='? (1761849363.py, line 6)",
     "output_type": "error",
     "traceback": [
      "\u001b[0;36m  Input \u001b[0;32mIn [18]\u001b[0;36m\u001b[0m\n\u001b[0;31m    searchType = 'all'\u001b[0m\n\u001b[0m    ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m invalid syntax. Maybe you meant '==' or ':=' instead of '='?\n"
     ]
    }
   ],
   "source": [
    "get_layer_features <- function( projectId = pid,\n",
    "                                layerId = lid,\n",
    "                                session = session,\n",
    "                                URL = \"https://focus.sensingclues.org/\",\n",
    "                                cookie = cookie) {\n",
    "  searchType = 'all'\n",
    "  \n",
    "  # select the proper source URL\n",
    "  url_layer <- paste0(URL,\"api/map/\",searchType,\"/\",projectId,\"/\",layerId,\"/features\")\n",
    "  \n",
    "  # initial call to get total and number of pages to get\n",
    "  handle_reset(url_layer)\n",
    "  result <- POST(url_layer, content_type_json(),  set_cookies(focus2 = URLdecode(cookie$value)))\n",
    "  layer <- content(result)\n",
    "  return(geojson_sf(toJSON(layer,auto_unbox=TRUE)))\n",
    "}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12be601c",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
